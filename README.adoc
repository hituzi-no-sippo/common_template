= Common Template Repository
:author: hituzi no sippo
:revnumber: v0.41.0
:revdate: 2022-07-11T07:57:34+09:00
:revremark: Add git hooks for check TOML format
:description: README
:copyright: copyright (c) 2022 {author}
:toc: rigth
:toclevels: 4
:creation_date: 2022-03-13T17:55:37+0900
:owner_name: hituzi-no-sippo
:repository_name: common_template
:repository: {owner_name}/{repository_name}
:github_url: https://github.com
:repository_url: {github_url}/{repository}
:github_actions_marketplace_url: {github_url}/marketplace/actions
:reviewdog_link: link:{github_url}/reviewdog/reviewdog[reviewdog^]
:pre_commit_config_file_path: .pre-commit-config.yaml
:pre_commit_orizinazation_url: {github_url}/pre-commit
:pre_commit_repository_url: {pre_commit_orizinazation_url}/pre-commit-hooks
:workflows_path: .github/workflows

== Linter & Formatter

=== Shell

:shfmt_link: link:{github_url}/mvdan/sh[shfmt^]
:shellcheck_link: link:https://www.shellcheck.net/[shellcheck]
[horizontal]
Formatter:: {shfmt_link}
Linter:: {shellcheck_link}

:filename: lint-shell.yml
:filename_on_pull_request: lint-shell-on-pull-request.yml
.GitHub Actions
* link:{workflows_path}/{filename}[{filename}^]
* link:{workflows_path}/{filename_on_pull_request}[{filename_on_pull_request}^]

:run_shellcheck_with_reviewdog_link: link:{github_actions_marketplace_url}/run-shellcheck-with-reviewdog[run-shellcheck-with-reviewdog^]
:run_shfmt_with_reviewdog_link: link:{github_actions_marketplace_url}/run-shfmt-with-reviewdog[run-shfmt-with-reviewdog^]
.{reviewdog_link}
{run_shellcheck_with_reviewdog_link}::
  Use link:{workflows_path}/{filename_on_pull_request}#:~:text=reviewdog/action%2Dshellcheck[{filename_on_pull_request}^].
{run_shfmt_with_reviewdog_link}::
  Use link:{workflows_path}/{filename_on_pull_request}#:~:text=reviewdog/action%2Dshfmt[{filename_on_pull_request}^].

:pre_commit_for_shell_format_link: link:{github_url}/scop/pre-commit-shfmt[scop/pre-commit-hooks^]
:pre_commit_for_shell_lint_url: {github_url}/koalaman/shellcheck-precommit
:pre_commit_for_shell_lint_link: link:{pre_commit_for_shell_lint_url}[koalaman/shellcheck-precommit^]
.Git Hooks
pre-commit::
format:::
  Use link:{pre_commit_config_file_path}#:~:text=%2D%20repo%3A%20https%3A//github.com/scop/pre%2Dcommit%2Dhooks[
  pre-commit^] ({pre_commit_for_shell_format_link}).
lint:::
  Use link:{pre_commit_config_file_path}#:~:text=repo%3A%20https%3A//github.com/koalaman/shellcheck%2Dprecommit[
  pre-commit^] ({pre_commit_for_shell_lint_link}). +
  Request {pre_commit_for_shell_lint_url}/blob/master/.pre-commit-hooks.yaml#:~:text=language%3A%20docker_image[
  docker^].

=== YAML

:prettier_link: link:https://prettier.io/[Prettier^]
:yamllint_link: link:https://yamllint.readthedocs.io/en/stable/index.html[yamllint^]
[horizontal]
Formatter::
  {prettier_link} +
  link:.prettierrc.yml[Configuration File^]
Linter::
  {yamllint_link} +
  link:.yamllint.yml[Configuration File^]

:yq_link: link:https://mikefarah.gitbook.io/yq/[yq^]
{yamllint_link} can not format.
I chose prettier because it had more configurable parameters than {yq_link}.

:pre_commit_for_yaml_format_link: {pre_commit_orizinazation_url}/mirrors-prettier[pre-commit/mirrors-prettier^]
:yamllint_github_url: {github_url}/adrienverge/yamllint
:pre_commit_for_yaml_lint_link: {yamllint_github_url}/blob/master/.pre-commit-hooks.yaml[yamllint pre-commit^]
.Git Hooks
pre-commit::
format:::
  Use link:{pre_commit_config_file_path}#:~:text=%2D%20repo%3A%20https%3A//github.com/pre%2Dcommit/mirrors%2Dprettier[
  pre-commit^] ({pre_commit_for_yaml_format_link}).
lint:::
  Use link:{pre_commit_config_file_path}#:~:text=repo%3A%20https%3A//github.com/adrienverge/yamllint.git[
  pre-commit^] ({pre_commit_for_yaml_lint_link}). +
  link:{pre_commit_repository_url}#check-yaml[
  pre-commit/pre-commit-hooks check-yaml^] is not used. It does not seem to load local configuration.

:filename: lint-yaml.yml
.GitHub Actions
* link:{workflows_path}/{filename}[{filename}^]

:run_yamllint_with_reviewdog: link:{github_actions_marketplace_url}/run-yamllint-with-reviewdog[run-yamllint-with-reviewdog^]
:run_prettier_with_reviewdog_link: link:{github_actions_marketplace_url}/run-prettier-with-reviewdog[run-prettier-with-reviewdog^]
.{reviewdog_link}
{run_yamllint_with_reviewdog}::
  Use link:{workflows_path}/{filename}#:~:text=reviewdog/action%2Dyamllint[{filename}^].
{run_prettier_with_reviewdog_link}::
  Use link:{workflows_path}/{filename}#:~:text=EPMatt/reviewdog%2Daction%2Dprettier[{filename}^].

=== TOML

:taplo_link: link:https://taplo.tamasfe.dev/[taplo^]
[horizontal]
Formatter & Linter::
  {taplo_link} +
  link:.taplo.toml[Configuration File^]

:filename: lint-toml.yml
.GitHub Actions
* link:{workflows_path}/{filename}[{filename}^]

:pre_commit_for_toml_format_and_lint_link: link:{github_url}/{owner_name}/pre-commit-toml[{owner_name}/pre-commit-toml^]
.Git Hooks
pre-commit::
format:::
  Use link:{pre_commit_config_file_path}#:~:text=id%3A%20format%2Dwith%2Dtaplo[
  pre-commit^] ({pre_commit_for_toml_format_and_lint_link}).

=== GitHub Actions

:actionlint_url: {github_url}/rhysd/actionlint
:actionlint_link: link:{actionlint_url}[actionlint^]
[horizontal]
Linter:: {actionlint_link}

:pre_commit_for_actionlint_lint_link: {actionlint_url}/blob/master/.pre-commit-hooks.yaml[actionlint pre-commit^]
.Git Hooks
pre-commit::
lint:::
  Use link:{actionlint_url}#:~:text=repo%3A%20https%3A//github.com/rhysd/actionlint.git[
  pre-commit^] ({pre_commit_for_yaml_lint_link}). +

:filename: lint-github-actions.yml
.GitHub Actions
* link:{workflows_path}/{filename}[{filename}^]

:actionlint_with_reviewdog_link: link:{github_actions_marketplace_url}/actionlint-with-reviewdog[actionlint-with-reviewdog^]
.{reviewdog_link}
{actionlint_with_reviewdog_link}::
  Use link:{workflows_path}/{filename}#:~:text=reviewdog/action%2Dactionlint[{filename}^].


== Git

=== Hooks

:pre_commit_link: link:https://pre-commit.com/[pre-commit^]
Use {pre_commit_link}. +
link:{pre_commit_config_file_path}[Configuration File^]

==== Setting Hooks
:pre_commit_version: v4.3.0
:pre_commit_tree_url: {pre_commit_repository_url}/tree/v4.3.0

:hardbreaks-option:

===== Style

:trim_trailing_whitespace_link: link:{pre_commit_repository_url}#trailing-whitespace[trim trailing whitespace^]
:end_of_line_fixer_link: link:{pre_commit_repository_url}#end-of-file-fixer[end of line fixer^]
:mixed_line_ending_link: link:{pre_commit_repository_url}#mixed-line-ending[mixed line ending^]
* {trim_trailing_whitespace_link}
  `end of line.____` (`_` is white space) => `end of line.`
  Markdown will not be trimmed.
* {end_of_line_fixer_link}
* {mixed_line_ending_link}

===== Git

:no_commit_to_branch_link: link:{pre_commit_repository_url}#no-commit-to-branch[no commit to branch]
:branch_protection_rules_documentation_link: link:https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/defining-the-mergeability-of-pull-requests[ \
  branch protection rules^]
:check_merge_conflict_link: link:{pre_commit_repository_url}#check-merge-conflict[check merge conflict]
:check_vcs_permalinks_link: link:{pre_commit_repository_url}#check-vcs-permalinks[check VCS permalinks]
* {no_commit_to_branch_link}
  Protect main and master branches from direct push.
  You could do something similar with {branch_protection_rules_documentation_link}.
* {check_merge_conflict_link}
* {check_vcs_permalinks_link}
+
--
:prefix_url: \https://github.com/{repository}
[horizontal]
correct:: `{prefix_url}/blob/5ef744fae1a633671154af16bba299104e0997fd/LICENSE#L1`
incorrect:: `{prefix_url}/blob/main/LICENSE#L1`
--

===== File

:fix_byte_order_marker_link: link:{pre_commit_repository_url}#fix-byte-order-marker[fix byte order marker^]
:check_case_conflict_link: link:{pre_commit_repository_url}#check-case-conflict[check case conflict^]
:check_added_large_files_link: link:{pre_commit_repository_url}#check-added-large-files[check added large files^]
* {fix_byte_order_marker_link}
* {check_case_conflict_link}
  Prevents add file with name that same on a case-insensitive.
  e.g. `readme.md`, `REAMDME.md`
* {check_added_large_files_link}
  Prevents adding files larger than the specified size.
  The maximum size is specified by `--maxkb` argument.
  Default maximum size 500kb.

===== Shebang

:check_executables_have_shebangs_link: link:{pre_commit_repository_url}#check-executables-have-shebangs[check executables have shebangs^]
:check_shebang_scripts_are_executable_link: link:{pre_commit_repository_url}#check-shebang-scripts-are-executable[check shebang scripts are executable^]
* {check_executables_have_shebangs_link}
  Check for files with execute permissions.
* {check_shebang_scripts_are_executable_link}
  Check for file with shebang.

:commit_hash_for_latest_version: 3298ddab3c13dd77d6ce1fc0baf97691430d84b0
===== Symlink

:check_symlinks_link: link:{pre_commit_repository_url}#check-symlinks[check broken symlinks^]
:destroyed_symlinks_link: link:{pre_commit_repository_url}#destroyed-symlinks[destroyed symlinks^]
:destroyed_symlinks_test_permalink_url: {pre_commit_repository_url}/blob/{commit_hash_for_latest_version}/tests/destroyed_symlinks_test.py#L33-L39
* {check_symlinks_link}
* {destroyed_symlinks_link}
  link:{destroyed_symlinks_test_permalink_url}[This is related to `core.symlinks`.^]

===== Security

:detect_private_keys_link: link:{pre_commit_repository_url}#detect-private-key[detect private keys^]
:block_list_link: link:{pre_commit_repository_url}/blob/{commit_hash_for_latest_version}/pre_commit_hooks/detect_private_key.py#L7-L16[Block List]
* {detect_private_keys_link}
  {block_list_link}

:!hardbreaks-option:

==== CI

:pre_commit_ci_url: https://pre-commit.ci
Use link:{pre_commit_ci_url}[pre-commit ci^].

:pre_commit_ci_result_url: https://results.pre-commit.ci
image:{pre_commit_ci_result_url}/badge/github/{repository}/main.svg[
link={pre_commit_ci_result_url}/latest/github/{repository}/main,
window=_blank]

link:{pre_commit_ci_url}#:~:text=get%20faster%20builds!-,automatic%20updates%3A,-pre%2Dcommit.ci[
pre-commit.ci will autoupdate version of hooks.^]
This autoupdate is currently scheduled
link:{pre_commit_config_file_path}#:~:text=autoupdate_schedule%3A%20weekly[
weekly^].

==== Auto Update

Create pull request for update pre-commit hooks if can update pre-commit hooks.

:filename: create-pull-request-for-update-pre-commit-hooks.yml
It is working on link:{workflows_path}/{filename}[{filename}^]

.When check for updates?
* Every Day (`cron: "0 0 * * *"`)
* link:{repository_url}/actions/workflows/{filename}[Run manually^]


== Introduction

:setup_shell_path: scripts/setup.sh
.Setup
. Create repository with this template.
** `gh repo create <REPOSITORY_NAME> --public --template {repository}`
** link:{repository_url}/generate[Use this template^].
. Clone repository. +
  `gh repo clone <REPOSITORY_NAME> && cd <REPOSITORY_NAME>`
. Run link:./{setup_shell_path}[setup shell^]. +
  `bash {setup_shell_path}`

== References

.YAML
* link:https://faun.pub/cli-tools-for-validating-and-linting-yaml-files-5627b66849b1[
  CLI tools for validating and linting YAML files^]


'''

This project is available under the link:./LICENSE[MIT-0^] License. +
link:https://choosealicense.com/licenses/mit-0/[
Preservation of copyright and license notices is not required.^]

Copyright (c) 2022 {author}
